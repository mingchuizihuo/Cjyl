<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.idea.cjyl.totalmodule.web.dao.myself.MansionMapperMyself" >
    <resultMap id="BaseResultMap" type="com.idea.cjyl.totalmodule.web.domain.vo.MansionVO" >
        <id column="id" property="id" jdbcType="BIGINT" />
        <result column="organization_login_id" property="organizationLoginId" jdbcType="BIGINT" />
        <result column="name" property="name" jdbcType="VARCHAR" />
        <result column="account_for" property="accountFor" jdbcType="VARCHAR" />
        <collection property="floorTierierList" resultMap="FloorTierVO">

        </collection>
    </resultMap>


    <resultMap id="FloorTierVO" type="com.idea.cjyl.totalmodule.web.domain.vo.FloorTierVO">

        <id column="id" property="id" jdbcType="BIGINT" />
        <result column="organization_login_id" property="organizationLoginId" jdbcType="BIGINT" />
        <result column="mansion_id" property="mansionId" jdbcType="BIGINT" />
        <result column="floor_tier" property="floorTier" jdbcType="VARCHAR" />
        <result column="account_for" property="accountFor" jdbcType="VARCHAR" />
        <collection property="roomList" resultMap="RoomVO"></collection>
    </resultMap>

    <resultMap id="RoomVO" type="com.idea.cjyl.totalmodule.web.domain.vo.RoomVO">

        <id column="id" property="id" jdbcType="BIGINT" />
        <result column="organization_login_id" property="organizationLoginId" jdbcType="BIGINT" />
        <result column="floor_tier_id" property="floorTierId" jdbcType="BIGINT" />
        <result column="room_num" property="roomNum" jdbcType="VARCHAR" />
        <result column="room_type" property="roomType" jdbcType="TINYINT" />
        <collection property="bedList" resultMap="Bed"></collection>
    </resultMap>

    <resultMap id="Bed" type="com.idea.cjyl.totalmodule.web.domain.pojo.Bed">
        <id column="id" property="id" jdbcType="BIGINT" />
        <result column="organization_login_id" property="organizationLoginId" jdbcType="BIGINT" />
        <result column="room_id" property="roomId" jdbcType="BIGINT" />
        <result column="bed_num" property="bedNum" jdbcType="TINYINT" />
        <result column="bed_state" property="bedState" jdbcType="TINYINT" />
        <result column="old_id" property="oldId" jdbcType="BIGINT" />
    </resultMap>
    <sql id="Base_Column_List" >
        mansion.id, mansion.organization_login_id, mansion.item, mansion.is_refund, mansion.money, mansion.account_for,
        floor.id, floor.organization_login_id, floor.mansion_id, floor.floor_tier, floor.account_for,
        room.id, room.organization_login_id, room.floor_tier_id, room.room_num, room.room_type,
        bed.id, bed.organization_login_id, bed.room_id, bed.bed_num, bed.bed_state, bed.old_id

    </sql>
    <select id="findAllVO" resultMap="BaseResultMap" parameterType="java.lang.Long" >

      SELECT
      <include refid="Base_Column_List" ></include>
      FROM mansion mansion
      LEFT JOIN floor_tier floor ON mansion.id = floor.mansion_id
      LEFT JOIN room room ON room.floor_tier_id = floor.id
      LEFT JOIN bed bed ON bed.room_id = room.id
      where organization_login_id = #{loginId,jdbcType=BIGINT}
    </select>
</mapper>